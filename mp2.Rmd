---
title: "Mini-Project 2"
author: "Marissa Freed, Natasha Rosenthal, & Margaret Welsh"
date: "March 31, 2018"
output: 
  html_document:
    code_folding: hide
---

Utilizing data from the Federal Election Commission based on the 2011â€“2012 federal election cycle, our group set out to answer a few key questions about parties and incumbency, looking at contested House of Representative elections across the nation.

Question: In contested House elections, looking at Democrats versus Republicans, who spends more money? Whose money is spent more effectively (which candidates win)? 
Does incumbency affect spending in contested elections?
To do: 
> Find who spends more money total: democrats or republicans? **
> Who wins more? Spends less doing so? (what percent of total spending for each race does the winner spend)
> Do incumbents spend more or less than their opposition? Does it differ for republicans and democrats? ***

```{r, include=FALSE}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggthemes)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

Before the 2012 elections, there were 193 Democrats and 242 Republicans in the House of Representatives, all of whom were up for reelection. Of the 432 House members, 42 did not run for reelection in 2012, and another 13 were defeated in their primary elections. For our analysis, we looked only at the elections in which two candidates of different parties ran against each other (so no non-contested elections). As we were looking at Democratic versus Republican spending, we also filtered out districts in which an incumbent beat a third-party candidate. 

```{r, warning=FALSE}
contributions %>%
  group_by(transaction_type) %>%
  summarize(n_ish = n_distinct(transaction_type))
#summarizing the contributions data frame after grouping by transaction_type so that we could see which types were included in the data
against_list <- c("24A", "24N")
#we found that codes 24A and 24N were donations made against a candidate
pro_contributions <- contributions %>%
  filter(transaction_type != against_list) %>%
  select(-employer, -occupation, -sub_id)
#this data frame includes all transaction codes except 24A and 24N--the "against_list".
anti_contributions <- contributions %>%
  filter(transaction_type == against_list)%>%
  select(-employer, -occupation, -sub_id)
#this data fram includes only the codes 24A and 24N
```

```{r, warning=FALSE}
house_demsreps <- house_elections %>%
  filter(general_votes !=0) %>%
  filter(party == "R" | party == "D") %>%
  mutate(st_dist = paste(state, district)) %>%
  select(-state, -district, -primary_votes, -runoff_votes) %>%
  arrange(st_dist)
#filtered the candidates in the house_elections data frame to only include Republican and Democrat candidates, those did not have 0 votes in the general election 
glimpse(house_demsreps)
```

```{r, warning=FALSE}
cand_conts <- pro_contributions %>%
  group_by(cmte_id, cand_id) %>%
  rename(fec_id = cand_id) %>%
  summarize(total_cont = sum(transaction_amt)) %>%
  inner_join(house_demsreps, by = "fec_id")
#joined our data frame that only includes donations in favor of the candidate with our data frame that only includes Republican & Democratic candidates
```

```{r, warning=FALSE}
totcont_percandidate <- cand_conts%>%
  group_by(fec_id, candidate_name, incumbent, party, general_votes, ge_winner, st_dist) %>%
  summarize(totaldonations = sum(total_cont))
#summarize to find the total donations for each candidate
```

```{r, warning=FALSE}
contested_districts <- totcont_percandidate %>%
  group_by(st_dist) %>%
  summarize(cont = n_distinct(fec_id)) %>%
  filter(cont != 1)
#Filtered to find the districts that were contested in the contributions data set 
contested_contributions <- contested_districts %>%
  inner_join(totcont_percandidate, by = "st_dist")
#join our filtered contributions data set with the filtered districts data set
```

### Who spends more money total: Democrats or Republicans?

This graph addresses the question of which major party raised more donations overall for their House candidates in the 2011-2012 federal election cycle, both incumbent and non-incumbent. It is clear that while the parties are nearly equal in donations, Republican candidates received slightly more than their democratic counterparts. A bar graph allows this data to be read clearly, and by mapping color to party, with blue representing Democrats and red representing Republicans, we allow the viewer to clearly comprehend the data based on their prior associations between these parties and their characteristic colors.

```{r, warning=FALSE}
dem_vs_repub <- contested_contributions %>%
  ggplot(aes(x = party, y = totaldonations, fill = party)) +
  geom_col(show.legend = FALSE) +
  scale_fill_manual(values = c("#34AAE0", "#E91D0E")) +
  labs(title = "Total Donations Broken Down by Party") +
  scale_x_discrete(name = " ", labels = c("Democrat", "Republican")) +
  scale_y_continuous(name = "Total Donations (In Millions)", breaks = c(0e+00, .5e+08, 1e+08, 1.5e+08, 2e+08, 2.5e+08), labels = c("$0", "$50", "$100", "$150", "$200", "$250")) +
  theme_fivethirtyeight()
dem_vs_repub
```


### Looking at average spending per candidate based on party, incumbency, and success:
```{r, warning=FALSE}
cc_sums <- contested_contributions %>%
  group_by(party, incumbent, ge_winner) %>%
  summarize(sumtotal = sum(totaldonations))


cc_nums <- contested_contributions %>%
  group_by(party, incumbent, ge_winner) %>%
  summarize(n_candidates = n_distinct(fec_id))


cc_nums %>%
  inner_join(cc_sums, by = c("party", "incumbent", "ge_winner")) %>%
  mutate(avg_amt_candidate = sumtotal/n_candidates)
```

### Do incumbents spend more or less than their opposition? Does it differ for republicans and democrats?
In the below graph, we answer the questions of whether incumbent or non-incumbents candidates raised more money, and how this differs across party lines. Across the board, incumbent candidates received more in donations than non-incumbents, collecting almost double the amount of money that non-incumbents did. However, the data show that while Democratic incumbents and non-incumbents received near the same amount in donations (with incumbents receiving slightly more than non-incumbents), Republican incumbents and non-incumbents received starkly different amounts. The data show that Republican incumbents received much more than non-incumbents. 

```{r, warning = FALSE}
incumbency_party <- contested_contributions %>%
  ggplot(aes(x = incumbent, y = totaldonations, fill = party)) +
  geom_col() +
  labs(title = "Donations For Non-Incumbents vs. Incumbents", size = 12) +
  scale_x_discrete(name = " ", labels = c("Non-Incumbent", "Incumbent")) +
  scale_y_continuous(name = "Total Donations (In Millions)", breaks = c(0e+00, .75e+08, 1.5e+08, 2.25e+08, 3e+08), labels = c("$0", "$75", "$150", "$225", "$300")) +
  scale_fill_manual(values = c("#34AAE0", "#E91D0E"), name = "Party", labels = c("Democrat", "Republican"))
incumbency_party + 
  theme_fivethirtyeight()
```
It seems that Republicans employ a strategy of focusing their fundraising efforts on ensuring incumbent wins rather than trying to establish new faces by pouring resources into non-incumbent candidates. Democrats, by comparison, seem to focus equally on incumbent and non-incumbent candidates as evidenced by their near-equal donations for both candidate types. This may be due to the tendency of Republicans to honor old, well-established traditions, both socially and economically, as well as the Democratic inclination toward youth and new ideas. We visualize this data using a stacked bar graph, allowing the viewer a clear look at the variance between the parties as well as the difference in donations for incumbent and non-incumbent candidates. Again, we continue the color mapping theme from the first graphic for clarity.

In short, these data, visualized by our two graphics, show the viewer which major party, between Democrats and Republicans, raised more funds, and how much fundraising focus both parties put on their incumbent candidates compared to non-incumbent candidates.




Link to GitHub repository:
https://github.com/freedmarissa/sds192-mp2